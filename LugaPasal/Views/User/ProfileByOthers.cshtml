@model LugaPasal.Models.ProfileViewModel
<div class="container-fluid">
    <div class="row p-4 gx-5">

        <!-- Left: Profile Info -->
        <div class="col-md-4">
            <div class="card shadow-lg rounded-3" style="overflow:hidden; width:80%">

                <!-- Profile Picture -->
                <div class="card-header text-center bg-gradient-primary text-white p-4" style="background: linear-gradient(to bottom, #356A95, #001B34);">
                    <img src="@(string.IsNullOrEmpty(Model.ProfilePicturePath)
                                                                                                                                                         ? Url.Content("~/images/icons/default.jpg")
                                                                                                                                                         : Model.ProfilePicturePath)"
                         class="rounded-circle border border-light shadow-sm"
                         style="width:120px; height:120px; object-fit:cover; transition: transform 0.3s ease;" />
                </div>

                <!-- Profile Info -->
                <div class="card-body d-flex flex-column gap-3 p-3">

                    <div class="d-flex justify-content-between">
                        <small class="text-muted fw-bold">First Name</small>
                        <span class="fw-medium">@Model.FirstName</span>
                    </div>
                    <div class="d-flex justify-content-between">
                        <small class="text-muted fw-bold">Last Name</small>
                        <span class="fw-medium">@Model.LastName</span>
                    </div>
                    <div class="d-flex justify-content-between">
                        <small class="text-muted fw-bold">Username</small>
                        <span class="fw-medium">@Model.Username</span>
                    </div>
                    <div class="d-flex justify-content-between">
                        <small class="text-muted fw-bold">Phone</small>
                        <span class="fw-medium">@Model.Phone</span>
                    </div>
                    <div class="d-flex justify-content-between">
                        <small class="text-muted fw-bold">Date of Birth</small>
                        <span class="fw-medium">@Model.DateOfBirth</span>
                    </div>
                    <div class="d-flex justify-content-between">
                        <small class="text-muted fw-bold">Email</small>
                        <span class="fw-medium">@Model.Email</span>
                    </div>
                    <div class="d-flex align-items-center justify-content-center gap-1 py-2">
                        @for (int i = 1; i <= 5; i++)
                        {
                            string starClass;
                            if (i <= Math.Floor(Convert.ToDecimal(Model.Rating)))
                            {
                                starClass = "bi bi-star-fill text-warning";
                            }
                            else if (i - Convert.ToDecimal(Model.Rating) < 1)
                            {
                                starClass = "bi bi-star-half text-warning";
                            }
                            else
                            {
                                starClass = "bi bi-star text-warning ";
                            }

                            <i class="@starClass" style="font-size:1.8rem; transition: transform 0.2s;"></i>
                        }

                        <span class="ms-3 text-muted fs-5">
                            @Model.Rating?.ToString("0.0") / 5
                        </span>
                    </div>


                    <!-- Buttons -->
                    <div class="d-flex justify-content-between mt-3">
                        <a class="btn btn-outline-secondary w-45" asp-controller="User" asp-action="Edit" asp-route-Id="@Model.Id">Edit</a>
                        <a class="btn btn-outline-danger w-45" asp-controller="User" asp-action="Logout">Logout</a>
                    </div>

                </div>
            </div>
        </div>

        <!-- Right: User's Products -->
        <div class="col-md-8">
            <div class="row g-3">
                @if (Model.ProductsOfUser != null && Model.ProductsOfUser.Any())
                {

                    @foreach (var product in Model.ProductsOfUser)

                    {
                        var productRating = product.Ratings != null && product.Ratings.Any() ? product.Ratings.Average(r => r.RatingValue) : 0.0;
                        <div class="col-md-4 g-3 p-3">
                            <a asp-action="ProductProfile" asp-controller="Product" asp-route-id="@product.ProductID" class="text-decoration-none text-black">
                                <div class="hover-shadow">
                                    <div class="card shadow-sm hover-shadow product-card h-100 border-0" style="cursor:pointer;border:none;min-height:20rem;">
                                        <div class="card-header bg-white p-0 text-center">
                                            <img src="@( !string.IsNullOrEmpty(product.ProductImagePath)
                                                                                                                                                                                                                                                                                                                                                                                                                ? product.ProductImagePath
                                                                                                                                                                                                                                                                                                                                                                                                                : Url.Content("~/images/profile/default.png"))"
                                                                                                                                                                                                                                                                                                                                                                                                                                                              class="rounded-top w-100" style="height:200px; object-fit:contain" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                     </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                     <div class="card-body p-3">
                                                                                                                                                                                                                                                                                                                                                                                                                                                         <h6 class="text-dark" style="font-size:18px;font-weight:normal;letter-spacing:0.6px;line-height:12px; font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;">@product.ProductName</h6>
                                                                                                                                                                                                                                                                                                                                                                                                                                                         <p class="card-text text-muted small card-limit">
                                               @(!string.IsNullOrEmpty(product.ProductDescription)
                                                                                       ? product.ProductDescription
                                                                                       : "No description available")
                                    </p>
                                </div>
                            </div>
                        </div>
                    </a>

                        </div>
                                }
                }
                else
                {
                    <div class="col">
                        <div class="border rounded shadow-sm p-4 text-center">
                            <span class="text-muted">No products to display.</span>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>
</div>
<style>

    .card {
        opacity: 0;
        animation: smoothPop 0.6s ease forwards;
    }

    @@keyframes smoothPop {
        from {
            opacity: 0;
            transform: translateY(15px) scale(0.98);
        }

        to {
            opacity: 1;
            transform: translateY(0) scale(1); /* Reset to normal state */
        }
    }

    body > div.container {
        max-width: 100% !important;
        padding-left: 3rem !important;
        padding-right: 5rem !important;
    }

    .container-fluid {
        margin-left: 0 !important;
        margin-right: 0 !important;
        padding-left: 15px !important;
        padding-right: 15px !important;
    }

    body {
        background-color: #f5f5f5;
    }

    .card-limit {
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .w-45 {
        width: 45%;
    }

    main {
        margin-bottom: 25px;
    }
</style>
