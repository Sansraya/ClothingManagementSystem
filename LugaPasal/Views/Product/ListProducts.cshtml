@model List<LugaPasal.Entities.Products>

@if (Model == null || !Model.Any())
{
    <div class="alert alert-warning text-center shadow-sm rounded-3">
        <strong>No results found.</strong> Try adjusting your search or browse all products.
    </div>
}
else
{
    <div class="container-fluid px-3 py-2">
        <div class="row g-4 " style="min-height:100vh;">
            <!-- Filters Column: Extreme Left -->
            <div class="col-12 col-md-2" >
                <form method="post" enctype="multipart/form-data" asp-action="ListProducts" asp-controller="Product" class="align-self-start">
                    <div class="card p-3 shadow-sm border-0 rounded-4" style="position: sticky; top:120px; background-color: #fdfdfd;">
                        <h5 class="mb-3 border-bottom pb-2 text-secondary fw-semibold">Filters</h5>

                        <!-- Category -->
                        <div class="mb-3">
                            <label for="category" class="form-label fw-semibold small text-muted">Category</label>
                            <select name="category" id="category" class="form-select form-select-sm">
                                <option value="">All</option>
                                <option value="Hoodie" selected="@(Context.Request.Query["category"] == "Hoodie")">Hoodie</option>
                                <option value="Pants" selected="@(Context.Request.Query["category"] == "Pants")">Pants</option>
                                <option value="Cardigan" selected="@(Context.Request.Query["category"] == "Cardigan")">Cardigan</option>
                                <option value="Shorts" selected="@(Context.Request.Query["category"] == "Shorts")">Shorts</option>
                                <option value="Shorts" selected="@(Context.Request.Query["category"] == "Shirts")">Shirts</option>
                            </select>
                        </div>

                        <!-- Price -->
                        <div class="mb-3">
                            <label class="form-label fw-semibold small text-muted">Price Range</label>
                            <div class="d-flex gap-2">
                                <input type="number" name="minPrice" placeholder="Min" value="@(Context.Request.Query["minPrice"])" class="form-control form-control-sm" />
                                <input type="number" name="maxPrice" placeholder="Max" value="@(Context.Request.Query["maxPrice"])" class="form-control form-control-sm" />
                            </div>
                        </div>

                        <!-- Quantity -->
                        <div class="mb-4">
                            <label class="form-label fw-semibold small text-muted">Min Quantity</label>
                            <input type="number" name="quantity" placeholder="Qty" value="@Context.Request.Query["quantity"]" class="form-control form-control-sm w-100" />
                        </div>

                        <!-- Buttons -->
                        <div class="d-flex gap-2">
                            <button type="submit" class="btn btn-secondary w-50 btn-sm">Filter</button>
                            <a asp-action="ListProducts" asp-controller="Product" class="btn btn-danger w-50 btn-sm">Reset</a>
                        </div>
                    </div>
                </form>
            </div>


            <!-- Products Column: Right -->
            <div class="col-12 col-md-10">
                <div class="row row-cols-1 row-cols-md-4 g-4">
                    @foreach (var product in Model)
                    {
                        <div class="col d-flex">
                            <a asp-action="ProductProfile" asp-controller="Product" asp-route-id="@product.ProductID" class="text-decoration-none text-dark">
                                <div class="card hover-shadow shadow-sm bg-light d-flex flex-column w-100" style="max-height:700px;">
                                    <div class="card-header bg-white h-100">
                                        <img src="@( !string.IsNullOrEmpty(product.ProductImagePath) ? product.ProductImagePath : Url.Content("~/images/icons/default.jpg") )"
                                             class="card-img-top rounded-2"
                                             style="height:200px; object-fit:contain;" />
                                    </div>
                                    <div class="card-body d-flex flex-column">
                                        <h5 class="card-title text-center" style="font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif">@product.ProductName 
                                            <span class="badge bg-secondary ms-2 text-uppercase" style="font-size:0.8rem;font-weight: normal; letter-spacing:1px;"> @(string.IsNullOrEmpty(product.ProductCategory) ? "Clothes" : product.ProductCategory) </span> </h5>
                                        <p class="card-text text-muted card-text-clamp" style="max-height:20rem;">
                                            @( string.IsNullOrEmpty(product.ProductDescription) ? "No description has been provided" : product.ProductDescription )
                                        </p>
                                        <p class="card-text text-black mt-auto" style="font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;">💰 Price: @product.ProductPrice 📦 Quantity: @product.ProductQuantity</p>
                                    </div>
                                    <div class="card-footer">
                                        <p class="card-text small text-muted">👤 Posted By: @product.User.UserName</p>
                                    </div>
                                </div>
                            </a>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>

}

<style>
    body > div.container {
        max-width: 100% !important;
        padding-left: 3rem !important;
        padding-right: 5rem !important;
    }

    .container-fluid {
        margin-left: 0 !important;
        margin-right: 0 !important;
        padding-left: 15px !important;
        padding-right: 15px !important;
        overflow: visible !important;
    }

    body {
        background-color: #f5f5f5;
    }

    .card-text-clamp {
        display: -webkit-box;
        -webkit-line-clamp: 3; /* show only 3 lines */
        -webkit-box-orient: vertical;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .hover-shadow {
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

        .hover-shadow:hover {
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.25);
            transform: translateY(-5px);
        }
</style>